cd /usr/src/freeswitch
# Make sure the module is listed in modules.conf
echo "applications/mod_audio_fork" >> modules.conf
# Regenerate the build system
./bootstrap.sh -j
# Reconfigure
./configure
# Then build
make mod_audio_fork-install




# 1. Make sure the module is in the right place
ls /usr/src/freeswitch/src/mod/applications/mod_audio_fork/
# Should show: mod_audio_fork.c, lws_glue.cpp, audio_pipe.cpp, parser.cpp, 
#              mod_audio_fork.h, lws_glue.h, audio_pipe.hpp, parser.hpp, 
#              base64.hpp, Makefile.am

# 2. Make sure modules.conf has the module listed
grep audio_fork /usr/src/freeswitch/modules.conf
# Should show: applications/mod_audio_fork

# 3. Make sure dependencies are installed
sudo apt-get install -y libwebsockets-dev libspeex-dev libspeexdsp-dev pkg-config
pkg-config --libs libwebsockets  # should output something like -lwebsockets

# 4. Regenerate the build system (CRITICAL STEP)
cd /usr/src/freeswitch
./bootstrap.sh -j

# 5. Reconfigure
./configure

# 6. Build just this module
make mod_audio_fork-install
